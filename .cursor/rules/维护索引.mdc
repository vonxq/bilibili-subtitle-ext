---
description: 代码索引维护规则，确保 CODEBASE-INDEX.md 与代码保持同步
alwaysApply: true
---

# 代码索引维护

## 索引文件
项目根目录 `CODEBASE-INDEX.md` 是代码库的开发使用说明索引，包含：
- 文件结构与行数
- 模块 API 索引（每个模块的依赖、公开方法、职责）
- 事件流、数据结构、CSS 架构
- chrome.storage 存储键

## 开发前必读
每次开始新的开发任务时，**先读取 `CODEBASE-INDEX.md`** 了解项目全貌，而非逐个读取源文件。只在需要修改具体文件时再读取该文件。

## 更新时机
完成以下任何一类修改后，必须同步更新 `CODEBASE-INDEX.md`：
1. **新增/删除/重命名文件**：更新文件结构树和行数
2. **修改模块公开 API**：更新对应模块的 API 描述
3. **新增/修改事件**：更新事件流图和 constants 描述
4. **修改数据结构**：更新数据结构章节
5. **新增/修改 CSS 变量**：更新 CSS 架构章节
6. **修改 manifest.json 加载顺序**：更新加载顺序章节

## 更新内容
- 更新受影响模块的 API 描述、依赖、行数
- 更新文件结构树中的行数（用 `wc -l` 获取准确值）
- 更新索引顶部的「最后更新」日期和总行数
- 不需要更新未受影响的模块描述
